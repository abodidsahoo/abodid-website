---
export const prerender = false;
import AdminLayout from "../../layouts/AdminLayout.astro";
import ThemeToggle from "../../components/ThemeToggle.astro";
import ContentEditor from "../../components/admin/ContentEditor.jsx";
---

<AdminLayout title="Editor" fullWidth={true}>
  <div style="position: absolute; top: 1rem; right: 1rem; z-index: 100;">
    <ThemeToggle />
  </div>
  <div id="editor-mount"></div>
</AdminLayout>

<script>
  import React from "react";
  import { createRoot } from "react-dom/client";
  import ContentEditor from "../../components/admin/ContentEditor.jsx";

  // Parse URL Params: /admin/editor?table=posts&id=new
  const params = new URLSearchParams(window.location.search);
  const table = params.get("table");
  const id = params.get("id");

  const container = document.getElementById("editor-mount");
  if (container) {
    const root = createRoot(container);

    if (table && id) {
      root.render(React.createElement(ContentEditor, { table, id }));
    } else {
      // Fallback or Error
      window.location.href = "/admin/dashboard";
    }
  }
</script>
