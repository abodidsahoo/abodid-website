---
import "../styles/global.css";
import Footer from "../components/Footer.astro";

const techStack = [
    {
        component: "Framework",
        tech: "Astro 5.0 (SSR) + React 19",
        purpose: "Hybrid rendering for performance & interactivity",
    },
    {
        component: "Styling",
        tech: "Tailwind CSS + Custom CSS",
        purpose: "Utility-first with bespoke design tokens",
    },
    {
        component: "Animations",
        tech: "GSAP 3 + Framer Motion",
        purpose: "Fluid interactions & narrative transitions",
    },
    {
        component: "Database",
        tech: "Supabase (PostgreSQL 15)",
        purpose: "Real-time data, auth (RLS), and storage",
    },
    {
        component: "Deployment",
        tech: "Vercel (Serverless)",
        purpose: "Edge network delivery & serverless functions",
    },
    {
        component: "Email",
        tech: "Resend",
        purpose: "Transactional & broadcast messaging",
    },
    {
        component: "Audio",
        tech: "Web Audio API",
        purpose: "Native browser audio processing without bloat",
    },
    {
        component: "AI Apps",
        tech: "OpenRouter (Ensemble)",
        purpose: "Multi-model consensus for aesthetic judgment",
    },
];

const consultationHref =
    "/contact?from=%2Farchitecture&source_name=website-architecture&cta=book-consultation";
---

<html lang="en">
    <head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-V07Z22DSVH"></script>
        <script is:inline>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-V07Z22DSVH');
        </script>
        <meta charset="utf-8" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="viewport" content="width=device-width" />
        <meta name="generator" content={Astro.generator} />
        <title>Website Architecture | Abodid</title>
        <script src="/scripts/journey-tracker.js" defer></script>
    </head>
    <body>
        <div class="architecture-page">
            <header class="arch-header">
                <div class="system-status-bar">
                    <div class="indicator-group user-select-none">
                        <div class="status-indicator online"></div>
                        <span class="mono-label">SYSTEM STATUS: ONLINE</span>
                    </div>
                </div>

                <h1 class="arch-title">Website Architecture</h1>
                <p class="arch-intro">
                    This digital space is a living, breathing extension of my
                    mind. It is designed to be a "Dark Room" for my work, a
                    place where
                    ideas develop slowly and clearly.
                </p>
            </header>

            <main class="arch-grid">
                {/* Tech Stack Section */}
                <section class="arch-section">
                    <h2 class="section-title">01 // The Stack</h2>
                    <div class="table-container">
                        <table class="tech-table">
                            <thead>
                                <tr>
                                    <th>Component</th>
                                    <th>Technology</th>
                                    <th>Purpose</th>
                                </tr>
                            </thead>
                            <tbody>
                                {
                                    techStack.map((item) => (
                                        <tr>
                                            <td>{item.component}</td>
                                            <td class="highlight">
                                                {item.tech}
                                            </td>
                                            <td class="muted">
                                                {item.purpose}
                                            </td>
                                        </tr>
                                    ))
                                }
                            </tbody>
                        </table>
                    </div>
                </section>

                {/* Typography & Design System */}
                <section class="arch-section two-col">
                    <div class="col-content">
                        <h2 class="section-title">02 // Typography System</h2>
                        <ul class="feature-list">
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Primary: Satoshi</strong>
                                    <p>
                                        The default typeface for headings, UI,
                                        and body copy across the site.
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Hierarchy by Weight</strong>
                                    <p>
                                        Visual hierarchy comes from spacing,
                                        size, and weight rather than mixing
                                        unrelated font families.
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Technical Labels</strong>
                                    <p>
                                        Code snippets and diagnostics use the
                                        mono stack via <code
                                            >var(--font-mono)</code
                                        > when needed.
                                    </p>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="col-content">
                        <h2 class="section-title">
                            03 // Logic & Optimization
                        </h2>
                        <ul class="feature-list">
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Obsidian Bridge</strong>
                                    <p>
                                        Private Edge Function parses raw
                                        Markdown wikilinks into HTML, bridging
                                        personal notes to public site.
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Atomic Research Engine</strong>
                                    <p>
                                        Client-side algorithm builds weighted
                                        frequency clouds instantly from JSON tag
                                        arrays.
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Lazy-Performance</strong>
                                    <p>
                                        <code>IntersectionObserver</code> keeps DOM
                                        light, loading 3D/Video assets only when scrolled
                                        into view.
                                    </p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </section>

                {/* Experience Engines */}
                <section class="arch-section two-col">
                    <div class="col-content">
                        <h2 class="section-title">04 // Audio Engine</h2>
                        <ul class="feature-list">
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Native Web Audio API</strong>
                                    <p>
                                        No heavy libraries. Pure browser-native
                                        audio processing for maximum
                                        performance.
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Real-time Spectrum</strong>
                                    <p>
                                        Visualizes audio frequencies using FFT
                                        (Fast Fourier Transform) data directly
                                        on screen.
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Scroll-based Ducking</strong>
                                    <p>
                                        Audio volume automatically lowers,
                                        "ducking" out of the way as you scroll
                                        down to read content.
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Lyric Synchronization</strong>
                                    <p>
                                        Precise time-stamp checking ensures
                                        lyrics appear exactly in rhythm with the
                                        music.
                                    </p>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="col-content">
                        <h2 class="section-title">
                            05 // Interactive Experiments
                        </h2>
                        <ul class="feature-list">
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Invisible Punctum</strong>
                                    <p>
                                        Live OpenRouter API connection analyzes
                                        image composition to generate poetic,
                                        AI-driven emotional narratives.
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Polaroid Physics</strong>
                                    <p>
                                        Card-stacking mechanism uses plane
                                        curves for distribution and
                                        physics-based drag gestures for natural
                                        interaction.
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Algorithmic Color</strong>
                                    <p>
                                        Adaptive palette generator clusters
                                        pixel data to sense the "mood" of
                                        images, creating dynamic themes.
                                    </p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </section>

                {/* Control Room & Broadcast */}
                <section class="arch-section two-col">
                    <div class="col-content">
                        <h2 class="section-title">06 // Custom CMS</h2>
                        <ul class="feature-list">
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Content Dashboard</strong>
                                    <p>
                                        Bespoke admin interface to manage
                                        research papers, films, and journals
                                        without touching code.
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Drag &amp; Drop Sequencing</strong>
                                    <p>
                                        Intuitively re-order content and curated
                                        lists using <code>dnd-kit</code> sortable
                                        interfaces.
                                    </p>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="col-content">
                        <h2 class="section-title">07 // Broadcast System</h2>
                        <ul class="feature-list">
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Newsletter Engine</strong>
                                    <p>
                                        Integrated system using Resend's Batch
                                        API to email thousands of subscribers
                                        instantly.
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Audience Logic</strong>
                                    <p>
                                        Segmented delivery ensures the right
                                        content reaches the right curious minds.
                                    </p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </section>

                {/* Awards & Ethics */}
                <section class="arch-section two-col">
                    <div class="col-content">
                        <h2 class="section-title">
                            08 // Ethics & Optimization
                        </h2>
                        <ul class="feature-list">
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Inclusive Design</strong>
                                    <p>
                                        ARIA-labeled visualizers, semantic <code
                                            >&lt;button&gt;</code
                                        > controls, and keyboard-navigable interfaces
                                        ensure access for all.
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Zero-Tracking</strong>
                                    <p>
                                        No cookies, no analytics pixels, no
                                        invasion. Just pure, unadulterated code.
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Reduced Motion</strong>
                                    <p>
                                        Respects system preferences to disable
                                        complex physics and parallax effects for
                                        sensitive users.
                                    </p>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="col-content">
                        <h2 class="section-title">09 // Award Protocols</h2>
                        <ul class="feature-list">
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Lighthouse Score</strong>
                                    <p>
                                        Targeting 4x100 (Performance,
                                        Accessibility, Best Practices, SEO) via
                                        static generation.
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Progressive Enhancement</strong>
                                    <p>
                                        Core content works without JavaScript.
                                        "Magic" is layered on top, not required
                                        for basic consumption.
                                    </p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </section>

                {/* Punctum AI Architecture */}
                <section class="arch-section two-col">
                    <div class="col-content">
                        <h2 class="section-title">
                            10 // Punctum AI Architecture
                        </h2>
                        <ul class="feature-list">
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Neuro-Symbolic Pipeline</strong>
                                    <p>
                                        A multi-stage AI reasoning engine that
                                        mimics human aesthetic judgment.
                                        Combines <code
                                            >NVIDIA Vision</code
                                        > for raw perception with <code
                                            >Gemini Pro</code
                                        > for poetic synthesis.
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Consensus Engine</strong>
                                    <p>
                                        The system doesn't just "see"—it
                                        compares. It actively calculates the
                                        semantic distance between Machine
                                        Interpretation (AI) and Human Feeling
                                        (User Input) to generate a "Consensus
                                        Score."
                                    </p>
                                </div>
                            </li>
                            <li>
                                <span class="bullet">→</span>
                                <div>
                                    <strong>Deep Dive</strong>
                                    <p>
                                        <a
                                            href="/architecture/punctum"
                                        >
                                            View the full schematic &rarr;
                                        </a>
                                    </p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </section>

                {/* CTA */}
                <section class="arch-cta">
                    <p class="cta-text">
                        I can help you build such a website and content
                        architecture in seven days.
                    </p>
                    <a
                        href={consultationHref}
                        class="cta-link">Book a consultation →</a
                    >
                </section>
            </main>
        </div>
        <aside
            id="floating-consult-cta"
            class="floating-consult-cta"
            aria-hidden="true"
        >
            <p class="floating-consult-copy">
                Build a site like this in 7 days!
            </p>
            <a href={consultationHref} class="floating-consult-button"
                >BOOK A CONSULTATION</a
            >
        </aside>
        <Footer />
        <script>
            const floatingConsultCta =
                document.getElementById("floating-consult-cta");

            if (floatingConsultCta) {
                let scrollEvents = 0;
                const minScrollDistance = 96;
                const minScrollEvents = 2;

                const syncFloatingCta = () => {
                    const shouldShow =
                        scrollEvents >= minScrollEvents &&
                        window.scrollY >= minScrollDistance;
                    floatingConsultCta.classList.toggle("is-visible", shouldShow);
                    floatingConsultCta.setAttribute(
                        "aria-hidden",
                        shouldShow ? "false" : "true"
                    );
                };

                let framePending = false;
                window.addEventListener(
                    "scroll",
                    () => {
                        scrollEvents += 1;
                        if (framePending) return;
                        framePending = true;
                        window.requestAnimationFrame(() => {
                            syncFloatingCta();
                            framePending = false;
                        });
                    },
                    { passive: true }
                );

                syncFloatingCta();
            }
        </script>
    </body>
</html>

<style>
    .architecture-page {
        max-width: var(--max-width);
        margin: 0 auto;
        padding: 2rem 24px 4rem;
    }

    .arch-header {
        margin-bottom: 3rem;
        border-bottom: 1px solid var(--border-subtle);
        padding-bottom: 2rem;
    }

    .system-status-bar {
        margin-bottom: 1.25rem;
        font-family: var(--font-ui);
        font-size: 0.75rem;
        letter-spacing: 0.08em;
        color: var(--text-tertiary);
        text-transform: uppercase;
    }

    .indicator-group {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
    }

    .status-indicator {
        width: 0.5rem;
        height: 0.5rem;
        border-radius: 50%;
        background: var(--accent-primary);
    }

    .arch-title {
        font-family: var(--font-display);
        font-size: clamp(2.4rem, 5vw, 4rem);
        font-weight: 600;
        letter-spacing: -0.02em;
        margin: 0 0 1rem;
        line-height: 1.1;
        color: var(--text-primary);
    }

    .arch-intro {
        margin: 0;
        font-family: var(--font-sans);
        font-size: 1.1rem;
        line-height: 1.6;
        color: var(--text-secondary);
        max-width: 760px;
    }

    .arch-grid {
        display: flex;
        flex-direction: column;
        gap: 3rem;
        margin-bottom: 3rem;
    }

    .arch-section {
        display: block;
    }

    .section-title {
        margin: 0 0 1.25rem;
        font-family: var(--font-display);
        font-size: clamp(1.35rem, 2vw, 1.9rem);
        font-weight: 600;
        letter-spacing: -0.01em;
        color: var(--text-primary);
    }

    .table-container {
        overflow-x: auto;
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-md);
        background: var(--bg-surface);
    }

    .tech-table {
        width: 100%;
        border-collapse: collapse;
        text-align: left;
        font-family: var(--font-sans);
        font-size: 0.95rem;
        min-width: 760px;
    }

    .tech-table th {
        border-bottom: 1px solid var(--border-subtle);
        padding: 0.9rem 1rem;
        color: var(--text-secondary);
        font-family: var(--font-ui);
        text-transform: uppercase;
        font-weight: 600;
        font-size: 0.78rem;
        letter-spacing: 0.05em;
    }

    .tech-table td {
        padding: 1rem;
        border-bottom: 1px solid var(--border-subtle);
        color: var(--text-primary);
        vertical-align: top;
    }

    .tech-table tbody tr:last-child td {
        border-bottom: none;
    }

    .tech-table .highlight {
        font-family: var(--font-ui);
        font-weight: 600;
    }

    .tech-table .muted {
        color: var(--text-secondary);
    }

    .two-col {
        display: grid;
        grid-template-columns: 1fr;
        gap: 2rem;
    }

    .col-content {
        min-width: 0;
    }

    .feature-list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        flex-direction: column;
        gap: 1.25rem;
    }

    .feature-list li {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 0.75rem;
        align-items: start;
    }

    .bullet {
        color: var(--text-tertiary);
        font-family: var(--font-ui);
        line-height: 1.5;
    }

    .feature-list strong {
        display: block;
        margin: 0 0 0.35rem;
        font-family: var(--font-display);
        font-size: 1.05rem;
        font-weight: 600;
        color: var(--text-primary);
    }

    .feature-list p {
        margin: 0;
        font-family: var(--font-sans);
        font-size: 1rem;
        line-height: 1.6;
        color: var(--text-secondary);
    }

    .feature-list code {
        font-family: var(--font-mono);
        font-size: 0.95em;
    }

    .feature-list a {
        color: var(--text-primary);
        text-decoration: underline;
        text-underline-offset: 0.16em;
    }

    .feature-list a:hover {
        color: var(--accent-primary);
    }

    .arch-cta {
        text-align: left;
        padding-top: 2.25rem;
        border-top: 1px solid var(--border-subtle);
    }

    .cta-text {
        margin: 0 0 1rem;
        font-family: var(--font-sans);
        font-size: 1.05rem;
        line-height: 1.65;
        color: var(--text-secondary);
        max-width: 760px;
    }

    .cta-link {
        display: inline-block;
        text-decoration: none;
        font-family: var(--font-ui);
        font-size: 0.9rem;
        font-weight: 600;
        color: #ffffff;
        background: var(--color-brand-red);
        border: 1px solid var(--color-brand-red);
        border-radius: 999px;
        padding: 0.7rem 1.1rem;
        transition:
            background-color 0.2s ease,
            border-color 0.2s ease,
            color 0.2s ease;
    }

    .cta-link:hover {
        background: #c21c3e;
        border-color: #c21c3e;
        color: #ffffff;
    }

    .floating-consult-cta {
        position: fixed;
        right: 1.5rem;
        bottom: clamp(3rem, 12vh, 6rem);
        transform: translateX(calc(100% + 1.5rem));
        opacity: 0;
        pointer-events: none;
        width: min(300px, calc(100vw - 2rem));
        padding: 0.75rem;
        border-radius: 10px;
        border: 1px solid var(--border-subtle);
        background: var(--bg-surface);
        box-shadow: 0 10px 28px rgba(0, 0, 0, 0.28);
        z-index: 80;
        transition:
            transform 0.9s cubic-bezier(0.22, 1, 0.36, 1),
            opacity 0.9s ease;
    }

    .floating-consult-cta.is-visible {
        transform: translateX(0);
        opacity: 1;
        pointer-events: auto;
    }

    .floating-consult-copy {
        margin: 0 0 0.6rem;
        text-align: left;
        font-family: var(--font-ui);
        font-size: clamp(0.74rem, 0.2vw + 0.72rem, 0.84rem);
        font-weight: 500;
        line-height: 1.28;
        color: var(--text-tertiary);
        letter-spacing: 0.02em;
        width: 100%;
        white-space: nowrap;
    }

    .floating-consult-button {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 58px;
        box-sizing: border-box;
        text-align: center;
        text-decoration: none;
        font-family: var(--font-ui);
        font-size: 1.2rem;
        line-height: 1;
        font-weight: 500;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        white-space: nowrap;
        color: #ffffff;
        background: var(--color-brand-red);
        border: 1px solid var(--color-brand-red);
        border-radius: 8px;
        padding: 0;
        transition:
            background-color 0.2s ease,
            border-color 0.2s ease,
            color 0.2s ease;
    }

    .floating-consult-button:hover {
        background: #c21c3e;
        border-color: #c21c3e;
        color: #ffffff;
    }

    @media (min-width: 1024px) {
        .two-col {
            grid-template-columns: repeat(2, minmax(0, 1fr));
            column-gap: 2.5rem;
            row-gap: 2rem;
        }
    }

    @media (max-width: 768px) {
        .architecture-page {
            padding: 1.5rem 16px 3rem;
        }

        .arch-header {
            margin-bottom: 2.5rem;
        }

        .arch-grid {
            gap: 2.5rem;
        }

        .tech-table {
            min-width: 620px;
        }

        .floating-consult-cta {
            right: 1rem;
            bottom: clamp(2rem, 10vh, 4rem);
            width: min(300px, calc(100vw - 2rem));
        }
    }

    @media (prefers-reduced-motion: reduce) {
        .floating-consult-cta {
            transition: none;
        }
    }
</style>
