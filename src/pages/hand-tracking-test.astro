---
export const prerender = false;
import HandTrackingDemo from "../components/hand-tracking-test/HandTrackingDemo.jsx";
import ExperimentLayout from "../layouts/ExperimentLayout.astro";
import { getFeaturedPhotography } from "../lib/api";

const pageTitle = "Hand Tracking Test";

// Fetch real photos from Supabase (same as landing page)
const featuredPhotography = await getFeaturedPhotography();

// Transform to match the format expected by the component
const images = featuredPhotography.map((photo) => ({
    image: photo.image, // cover_image from Supabase
    title: photo.title,
}));

// Fallback to sample images if database is empty or fails
if (images.length === 0) {
    images.push(
        {
            image: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800",
            title: "Mountain Landscape",
        },
        {
            image: "https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=800",
            title: "Forest Path",
        },
        {
            image: "https://images.unsplash.com/photo-1501594907352-04cda38ebc29?w=800",
            title: "Ocean Waves",
        },
    );
}
---

<ExperimentLayout
    title={pageTitle}
    description="Hand-tracking prototype for spawning and controlling visual cards."
    lockViewport={true}
    bodyClass="hand-tracking-page"
>
    <HandTrackingDemo client:only="react" images={images} />
</ExperimentLayout>

<style>
    :global(body.hand-tracking-page) {
        background: #000;
        color: #fff;
        overflow: hidden;
    }

    :global(body.hand-tracking-page #main-content) {
        height: 100vh;
    }
</style>
